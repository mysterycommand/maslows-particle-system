(this["webpackJsonpmaslows-particle-system"]=this["webpackJsonpmaslows-particle-system"]||[]).push([[0],[,function(e,s,t){"use strict";let a;t.d(s,"a",(function(){return a})),function(e){e.Self="Self",e.Other="Other"}(a||(a={}))},function(e,s,t){e.exports={Form:"Form_Form__2boAo",Input:"Form_Input__1kIqz",Button:"Form_Button__1q5fL"}},function(e,s,t){e.exports={Message:"Message_Message__L9LXR",Self:"Message_Self__13TvW",Other:"Message_Other__oJUsj"}},function(e,s,t){e.exports={Device:"App_Device__1vnMx",Header:"App_Header__2rl_K",Footer:"App_Footer__3E1PI"}},function(e,s,t){e.exports={Messages:"Messages_Messages__2D-Ym",Sentinel:"Messages_Sentinel__286rc"}},,function(e,s,t){"use strict";(function(e){t.d(s,"a",(function(){return l}));var a=t(0),n=t.n(a),r=t(11),o=t(1),c=t(5),i=t.n(c);const l=({messages:s,messagesTop:t,messagesHeight:c,dispatch:l})=>{const g=Object(a.useRef)(null),m=Object(a.useRef)(null),u=Object(a.useRef)(!0),p=Object(a.useRef)(t);p.current=t;const d=Object(a.useRef)(c);return d.current=c,Object(a.useEffect)(()=>{if(!g.current)return;const e=g.current,s=e.clientHeight-8;l({type:"setMessagesHeight",payload:{messagesHeight:e.clientHeight}});const t=()=>{e.scrollTop<p.current&&e.scrollTop<s&&(e.scrollTop=s),l({type:"setMessagesTop",payload:{messagesTop:e.scrollTop}});const t=e.scrollTop+e.clientHeight,a=d.current-e.clientHeight/3;u.current=t>a};return e.addEventListener("scroll",t,{passive:!0}),()=>{e.removeEventListener("scroll",t)}},[l]),Object(a.useEffect)(()=>{var t;const a=(null===(t=s[s.length-1])||void 0===t?void 0:t.sender)===o.a.Self;(u.current||a)&&e(()=>{m.current&&m.current.scrollIntoView({behavior:"smooth"})})},[s]),n.a.createElement("ol",{className:i.a.Messages,ref:g},s.reduce((e,{id:s,createdAt:a,sender:o,content:i,top:m,height:u})=>{if(!g.current)return e;const{clientHeight:p}=g.current;return void 0!==m&&void 0!==u&&!(m&&u&&m<t+p&&m+u>t)||e.push(n.a.createElement(r.a,{key:s,id:s,createdAt:a,sender:o,content:i,top:m,height:u,messagesHeight:c,dispatch:l})),e},[]),n.a.createElement("li",{className:i.a.Sentinel,style:{top:c},ref:m}))}}).call(this,t(18).setImmediate)},,,,function(e,s,t){"use strict";t.d(s,"a",(function(){return u}));var a=t(10),n=t(0),r=t.n(n),o=t(1),c=t(3),i=t.n(c);const{getComputedStyle:l}=window,g=e=>{const{marginTop:s}=l(e);return e.offsetTop-parseInt(s,10)},m=e=>{const{marginTop:s,height:t,marginBottom:a}=l(e);return[s,t,a].reduce((e,s)=>e+parseInt(s,10),0)},u=({id:e,createdAt:s,sender:t,content:c,top:l,height:u,messagesHeight:p,dispatch:d})=>{const h=Object(n.useRef)(null);return Object(n.useEffect)(()=>{h.current&&void 0===l&&void 0===u&&d({type:"renderMessage",payload:{id:e,top:p+g(h.current),height:m(h.current)}})},[d,u,e,p,l]),r.a.createElement("li",{className:Object(a.a)({[i.a.Message]:!0,[i.a.Self]:t===o.a.Self,[i.a.Other]:t===o.a.Other}),title:s,style:{top:l},ref:h},c)}},function(e,s,t){e.exports=t(21)},function(e,s,t){},,,,,,,,function(e,s,t){"use strict";t.r(s);t(13);var a=t(0),n=t.n(a),r=t(9),o=t.n(r),c=t(23),i=t(1),l=t(2),g=t.n(l);const m=({dispatch:e})=>{const[s,t]=Object(a.useState)("");return n.a.createElement("form",{action:"",className:g.a.Form,onSubmit:a=>{a.preventDefault(),e({type:"addMessage",payload:{sender:i.a.Self,content:s}}),setTimeout(()=>{e({type:"addMessage",payload:{sender:i.a.Other,content:s}})},2e3),t("")}},n.a.createElement("input",{type:"text",className:g.a.Input,value:s,onChange:e=>{t(e.target.value)}}),n.a.createElement("button",{type:"submit",className:g.a.Button,disabled:""===s},"\u2191"))};var u=t(7),p=t(4),d=t.n(p);const h=(e,s)=>{switch(s.type){case"setMessagesTop":return{messages:e.messages,messagesTop:s.payload.messagesTop,messagesHeight:e.messagesHeight};case"setMessagesHeight":return{messages:e.messages,messagesTop:e.messagesTop,messagesHeight:s.payload.messagesHeight};case"addMessage":return{messages:[...e.messages,{id:Object(c.a)(),createdAt:(new Date).toISOString(),...s.payload}],messagesTop:e.messagesTop,messagesHeight:e.messagesHeight};case"renderMessage":const t=e.messages.find(e=>e.id===s.payload.id),a=t?e.messages.indexOf(t):-1;return t&&-1!==a?{messages:[...e.messages.slice(0,a),{...t,top:s.payload.top,height:s.payload.height},...e.messages.slice(a+1)],messagesTop:e.messagesTop,messagesHeight:e.messagesHeight+s.payload.height}:e;default:return e}},f=()=>{const[{messages:e,messagesTop:s,messagesHeight:t},r]=Object(a.useReducer)(h,{messages:[],messagesTop:0,messagesHeight:0});return n.a.createElement("article",{className:d.a.Device},n.a.createElement("header",{className:d.a.Header},"Echo"),n.a.createElement(u.a,{messages:e,messagesTop:s,messagesHeight:t,dispatch:r}),n.a.createElement("footer",{className:d.a.Footer},n.a.createElement(m,{dispatch:r})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(f,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()}).catch(e=>{console.error(e.message)})}],[[12,1,2]]]);
//# sourceMappingURL=main.b55f069a.chunk.js.map