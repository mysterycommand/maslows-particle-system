{"version":3,"sources":["app/types.ts","app/index.ts","components/Form/Form.module.css","components/Message/Message.module.css","components/App/App.module.css","components/Messages/Messages.module.css","components/Messages/Messages.tsx","components/Fireworks/Fireworks.module.css","components/Message/Message.tsx","components/Fireworks/Fireworks.tsx","components/Form/Form.tsx","components/App/App.tsx","serviceWorker.ts","index.tsx"],"names":["Sender","reducer","state","action","type","messages","messagesTop","payload","messagesHeight","isShowingFireworks","id","uuid","createdAt","Date","toISOString","message","find","m","index","indexOf","slice","top","height","initialState","module","exports","Messages","dispatch","messagesElRef","useRef","sentinelElRef","isNearBottom","messagesTopRef","current","messagesHeightRef","useEffect","el","minScroll","clientHeight","onScroll","scrollTop","scrollBottom","messagesBottom","addEventListener","passive","removeEventListener","isOwnMessage","length","sender","Self","setImmediate","scrollIntoView","behavior","className","style","ref","reduce","acc","content","undefined","push","key","Sentinel","getComputedStyle","getStyle","window","outerTop","marginTop","offsetTop","parseInt","outerHeight","marginBottom","px","Message","messageElRef","clsx","Other","title","devicePixelRatio","dpr","requestAnimationFrame","raf","cancelAnimationFrame","caf","cos","PI","π","random","sin","Math","ππ","particles","gravity","x","y","p","theta","radius","currPos","prevPos","hue","add","a","b","Fireworks","canvasElRef","context","setContext","useState","parentElement","width","getBoundingClientRect","opacity","getContext","w","h","hw","hh","frameId","firstTime","normalTime","onFrame","time","emitX","emitY","i","fillStyle","fillRect","forEach","particle","currVel","nextPos","update","ctx","beginPath","ellipse","fill","render","setTimeout","Form","setMessage","onSubmit","event","preventDefault","Input","value","onChange","target","Button","disabled","App","useReducer","wrappedDispatch","useCallback","trim","Device","Header","Footer","Boolean","location","hostname","match","ReactDOM","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console"],"mappings":"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","file":"static/js/main.04936e3f.chunk.js","sourcesContent":["export enum Sender {\n  Self = 'Self',\n  Other = 'Other',\n}\n\nexport interface MessageData {\n  id: string;\n  createdAt: string;\n  sender: Sender;\n  content: string;\n  top?: number;\n  height?: number;\n}\n\nexport interface AppState {\n  messages: MessageData[];\n  messagesTop: number;\n  messagesHeight: number;\n  isShowingFireworks: boolean;\n}\n\nexport interface SetMessagesTopAction {\n  type: 'setMessagesTop';\n  payload: {\n    messagesTop: number;\n  };\n}\n\nexport interface SetMessagesHeightAction {\n  type: 'setMessagesHeight';\n  payload: {\n    messagesHeight: number;\n  };\n}\n\nexport interface AddMessageAction {\n  type: 'addMessage';\n  payload: {\n    sender: Sender;\n    content: string;\n  };\n}\n\nexport interface RenderMessageAction {\n  type: 'renderMessage';\n  payload: {\n    id: string;\n    top: number;\n    height: number;\n  };\n}\n\nexport interface SetIsShowingFireworksAction {\n  type: 'setIsShowingFireworks';\n  payload: {\n    isShowingFireworks: boolean;\n  };\n}\n\nexport type AppAction =\n  | SetMessagesTopAction\n  | SetMessagesHeightAction\n  | AddMessageAction\n  | RenderMessageAction\n  | SetIsShowingFireworksAction;\n","import { Reducer } from 'react';\nimport { v4 as uuid } from 'uuid';\n\nimport { AppAction, AppState } from './types';\n\nexport * from './types';\n\nexport const reducer: Reducer<AppState, AppAction> = (state, action) => {\n  switch (action.type) {\n    case 'setMessagesTop':\n      return {\n        messages: state.messages,\n        messagesTop: action.payload.messagesTop,\n        messagesHeight: state.messagesHeight,\n        isShowingFireworks: state.isShowingFireworks,\n      };\n    case 'setMessagesHeight':\n      return {\n        messages: state.messages,\n        messagesTop: state.messagesTop,\n        messagesHeight: action.payload.messagesHeight,\n        isShowingFireworks: state.isShowingFireworks,\n      };\n    case 'addMessage':\n      return {\n        messages: [\n          ...state.messages,\n          {\n            id: uuid(),\n            createdAt: new Date().toISOString(),\n            ...action.payload,\n          },\n        ],\n        messagesTop: state.messagesTop,\n        messagesHeight: state.messagesHeight,\n        isShowingFireworks: state.isShowingFireworks,\n      };\n    case 'renderMessage':\n      const message = state.messages.find((m) => m.id === action.payload.id);\n      const index = message ? state.messages.indexOf(message) : -1;\n\n      return message && index !== -1\n        ? {\n            messages: [\n              ...state.messages.slice(0, index),\n              {\n                ...message,\n                top: action.payload.top,\n                height: action.payload.height,\n              },\n              ...state.messages.slice(index + 1),\n            ],\n            messagesTop: state.messagesTop,\n            messagesHeight: state.messagesHeight + action.payload.height,\n            isShowingFireworks: state.isShowingFireworks,\n          }\n        : state;\n    case 'setIsShowingFireworks':\n      return {\n        messages: state.messages,\n        messagesTop: state.messagesTop,\n        messagesHeight: state.messagesHeight,\n        isShowingFireworks: action.payload.isShowingFireworks,\n      };\n    default:\n      return state;\n  }\n};\n\nexport const initialState: AppState = {\n  messages: [],\n  messagesTop: 0,\n  messagesHeight: 0,\n  isShowingFireworks: false,\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Form\":\"Form_Form__2boAo\",\"Input\":\"Form_Input__1kIqz\",\"Button\":\"Form_Button__1q5fL\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Message\":\"Message_Message__L9LXR\",\"Self\":\"Message_Self__13TvW\",\"Other\":\"Message_Other__oJUsj\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Device\":\"App_Device__1vnMx\",\"Header\":\"App_Header__2rl_K\",\"Footer\":\"App_Footer__3E1PI\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Messages\":\"Messages_Messages__2D-Ym\",\"Sentinel\":\"Messages_Sentinel__286rc\"};","import React, { Dispatch, FC, ReactNode, useEffect, useRef } from 'react';\n\nimport { AppAction, MessageData, Sender } from '../../app';\n\nimport { Message } from '../Message';\n\nimport style from './Messages.module.css';\n\ninterface Props {\n  messages: MessageData[];\n  messagesTop: number;\n  messagesHeight: number;\n  dispatch: Dispatch<AppAction>;\n}\n\nexport const Messages: FC<Props> = ({\n  messages,\n  messagesTop,\n  messagesHeight,\n  dispatch,\n}) => {\n  const messagesElRef = useRef<HTMLOListElement>(null);\n  const sentinelElRef = useRef<HTMLLIElement>(null);\n\n  const isNearBottom = useRef(true);\n\n  const messagesTopRef = useRef(messagesTop);\n  messagesTopRef.current = messagesTop;\n\n  const messagesHeightRef = useRef(messagesHeight);\n  messagesHeightRef.current = messagesHeight;\n\n  useEffect(() => {\n    if (!messagesElRef.current) {\n      return;\n    }\n\n    const el = messagesElRef.current;\n    const minScroll = el.clientHeight - 8;\n\n    dispatch({\n      type: 'setMessagesHeight',\n      payload: {\n        messagesHeight: el.clientHeight,\n      },\n    });\n\n    const onScroll = () => {\n      if (el.scrollTop < messagesTopRef.current && el.scrollTop < minScroll) {\n        el.scrollTop = minScroll;\n      }\n\n      dispatch({\n        type: 'setMessagesTop',\n        payload: {\n          messagesTop: el.scrollTop,\n        },\n      });\n\n      const scrollBottom = el.scrollTop + el.clientHeight;\n      const messagesBottom = messagesHeightRef.current - el.clientHeight / 3;\n      isNearBottom.current = scrollBottom > messagesBottom;\n    };\n\n    el.addEventListener('scroll', onScroll, { passive: true });\n    return () => {\n      el.removeEventListener('scroll', onScroll);\n    };\n  }, [dispatch]);\n\n  useEffect(() => {\n    const isOwnMessage = messages[messages.length - 1]?.sender === Sender.Self;\n\n    if (isNearBottom.current || isOwnMessage) {\n      setImmediate(() => {\n        if (!sentinelElRef.current) {\n          return;\n        }\n\n        sentinelElRef.current.scrollIntoView({\n          behavior: 'smooth',\n        });\n      });\n    }\n  }, [messages]);\n\n  return (\n    <ol className={style.Messages} ref={messagesElRef}>\n      {messages.reduce<ReactNode[]>(\n        (acc, { id, createdAt, sender, content, top, height }) => {\n          if (!messagesElRef.current) {\n            return acc;\n          }\n\n          const { clientHeight } = messagesElRef.current;\n          const didMeasure = top !== undefined && height !== undefined;\n          const isInBounds =\n            top &&\n            height &&\n            top < messagesTop + clientHeight &&\n            top + height > messagesTop;\n\n          if (!didMeasure || isInBounds) {\n            acc.push(\n              <Message\n                key={id}\n                id={id}\n                createdAt={createdAt}\n                sender={sender}\n                content={content}\n                top={top}\n                height={height}\n                messagesHeight={messagesHeight}\n                dispatch={dispatch}\n              />,\n            );\n          }\n\n          return acc;\n        },\n        [],\n      )}\n      <li\n        className={style.Sentinel}\n        style={{ top: messagesHeight }}\n        ref={sentinelElRef}\n      ></li>\n    </ol>\n  );\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Fireworks\":\"Fireworks_Fireworks__20lpI\"};","import clsx from 'clsx';\nimport React, { Dispatch, FC, useEffect, useRef } from 'react';\n\nimport { AppAction, MessageData, Sender } from '../../app';\n\nimport style from './Message.module.css';\n\ninterface Props extends MessageData {\n  messagesHeight: number;\n  dispatch: Dispatch<AppAction>;\n}\n\nconst { getComputedStyle: getStyle } = window;\n\nconst outerTop: (el: HTMLElement) => number = (el) => {\n  const { marginTop } = getStyle(el);\n  return el.offsetTop - parseInt(marginTop, 10);\n};\n\nconst outerHeight: (el: HTMLElement) => number = (el) => {\n  const { marginTop, height, marginBottom } = getStyle(el);\n  return [marginTop, height, marginBottom].reduce(\n    (acc, px) => acc + parseInt(px, 10),\n    0,\n  );\n};\n\nexport const Message: FC<Props> = ({\n  id,\n  createdAt,\n  sender,\n  content,\n  top,\n  height,\n  messagesHeight,\n  dispatch,\n}) => {\n  const messageElRef = useRef<HTMLLIElement>(null);\n\n  useEffect(() => {\n    if (!messageElRef.current) {\n      return;\n    }\n\n    if (top === undefined && height === undefined) {\n      dispatch({\n        type: 'renderMessage',\n        payload: {\n          id,\n          top: messagesHeight + outerTop(messageElRef.current),\n          height: outerHeight(messageElRef.current),\n        },\n      });\n    }\n  }, [dispatch, height, id, messagesHeight, top]);\n\n  return (\n    <li\n      className={clsx({\n        [style.Message]: true,\n        [style.Self]: sender === Sender.Self,\n        [style.Other]: sender === Sender.Other,\n      })}\n      title={createdAt}\n      style={{\n        top,\n      }}\n      ref={messageElRef}\n    >\n      {content}\n    </li>\n  );\n};\n","import React, { FC, useEffect, useRef, useState, Dispatch } from 'react';\n\nimport { AppAction } from '../../app';\n\nimport style from './Fireworks.module.css';\n\ninterface Vec2 {\n  x: number;\n  y: number;\n}\n\ninterface Particle {\n  currPos: Vec2;\n  prevPos: Vec2;\n  hue: number;\n}\n\ninterface Props {\n  dispatch: Dispatch<AppAction>;\n}\n\nconst {\n  devicePixelRatio: dpr,\n  requestAnimationFrame: raf,\n  cancelAnimationFrame: caf,\n} = window;\n\nconst { cos, PI: π, random, sin } = Math;\nconst ππ = π * 2;\n\nlet particles: Particle[] = [];\n\nconst maxSpeed = 15;\nconst gravity: Vec2 = { x: 0, y: 0.2 };\n\nconst p: (x: number, y: number) => Particle = (x, y) => {\n  const theta = random() * ππ;\n  const radius = random() * maxSpeed;\n\n  return {\n    currPos: { x, y },\n    prevPos: {\n      x: x + cos(theta) * radius,\n      y: y + sin(theta) * radius,\n    },\n    hue: random() * ππ * (180 / π),\n  };\n};\n\nconst add: (a: Vec2, b: Vec2) => Vec2 = (a, b) => ({\n  x: a.x + b.x,\n  y: a.y + b.y,\n});\n\nconst sub: (a: Vec2, b: Vec2) => Vec2 = (a, b) => ({\n  x: a.x - b.x,\n  y: a.y - b.y,\n});\n\nconst update: (particle: Particle) => void = (p) => {\n  const currVel = add(sub(p.currPos, p.prevPos), gravity);\n  const nextPos = add(p.currPos, currVel);\n\n  p.prevPos = p.currPos;\n  p.currPos = nextPos;\n};\n\nconst render: (\n  context: CanvasRenderingContext2D,\n  particle: Particle,\n) => void = (ctx, { currPos, prevPos, hue }) => {\n  ctx.beginPath();\n  ctx.fillStyle = `hsl(${hue}, 80%, 50%)`;\n  ctx.ellipse(currPos.x, currPos.y, 5, 5, 0, 0, ππ);\n  ctx.fill();\n\n  ctx.beginPath();\n  ctx.fillStyle = `hsl(${(hue + 180) % 360}, 80%, 50%)`;\n  ctx.ellipse(prevPos.x, prevPos.y, 5, 5, 0, 0, ππ);\n  ctx.fill();\n};\n\nexport const Fireworks: FC<Props> = ({ dispatch }) => {\n  const canvasElRef = useRef<HTMLCanvasElement>(null);\n  const [context, setContext] = useState<CanvasRenderingContext2D | null>(null);\n\n  useEffect(() => {\n    if (!(canvasElRef.current && canvasElRef.current.parentElement)) {\n      return;\n    }\n\n    const {\n      width,\n      height,\n    } = canvasElRef.current.parentElement.getBoundingClientRect();\n\n    canvasElRef.current.width = width * dpr;\n    canvasElRef.current.height = height * dpr;\n    canvasElRef.current.style.opacity = '1';\n\n    setContext(canvasElRef.current.getContext('2d'));\n  }, []);\n\n  useEffect(() => {\n    if (!(canvasElRef.current && context)) {\n      return;\n    }\n\n    const { width: w, height: h } = canvasElRef.current;\n    const hw = w / 2;\n    const hh = h / 2;\n\n    let frameId: number;\n    let firstTime = 0;\n    let normalTime = 0;\n\n    const onFrame: FrameRequestCallback = (time: DOMHighResTimeStamp) => {\n      frameId = raf(onFrame);\n\n      firstTime || (firstTime = time);\n      normalTime = time - firstTime;\n\n      if (normalTime % 1_000 < 16 && normalTime < 5_000) {\n        const emitX = hw / 2 + random() * hw;\n        const emitY = hh / 4 + random() * hh;\n\n        for (let i = 0; i < 100; ++i) {\n          particles.push(p(emitX, emitY));\n        }\n      }\n\n      context.fillStyle = 'black';\n      context.fillRect(0, 0, w, h);\n\n      particles.forEach((particle) => {\n        update(particle);\n        render(context, particle);\n      });\n\n      particles = particles.reduce<Particle[]>((acc, p) => {\n        const {\n          currPos: { x, y },\n        } = p;\n\n        if (0 < x && x < w && 0 < y && y < h) {\n          acc.push(p);\n        }\n\n        return acc;\n      }, []);\n\n      if (normalTime > 5_000 && particles.length === 0 && canvasElRef.current) {\n        canvasElRef.current.style.opacity = '0';\n        caf(frameId);\n\n        setTimeout(() => {\n          dispatch({\n            type: 'setIsShowingFireworks',\n            payload: {\n              isShowingFireworks: false,\n            },\n          });\n        }, 400);\n      }\n    };\n\n    frameId = raf(onFrame);\n    return () => {\n      caf(frameId);\n    };\n  }, [context, dispatch]);\n\n  return <canvas className={style.Fireworks} ref={canvasElRef}></canvas>;\n};\n","import React, { Dispatch, FC, useState } from 'react';\n\nimport { AppAction, Sender } from '../../app';\n\nimport style from './Form.module.css';\n\ninterface Props {\n  dispatch: Dispatch<AppAction>;\n}\n\nexport const Form: FC<Props> = ({ dispatch }) => {\n  const [message, setMessage] = useState('');\n\n  return (\n    <form\n      action=\"\"\n      className={style.Form}\n      onSubmit={(event) => {\n        event.preventDefault();\n\n        dispatch({\n          type: 'addMessage',\n          payload: {\n            sender: Sender.Self,\n            content: message,\n          },\n        });\n\n        setMessage('');\n      }}\n    >\n      <input\n        type=\"text\"\n        className={style.Input}\n        value={message}\n        onChange={(event) => {\n          setMessage(event.target.value);\n        }}\n      />\n      <button type=\"submit\" className={style.Button} disabled={message === ''}>\n        ↑\n      </button>\n    </form>\n  );\n};\n","import React, { FC, useCallback, useReducer } from 'react';\n\nimport { AppAction, initialState, reducer, Sender } from '../../app';\n\nimport { Fireworks } from '../Fireworks';\nimport { Form } from '../Form';\nimport { Messages } from '../Messages';\n\nimport style from './App.module.css';\n\nexport const App: FC = () => {\n  const [\n    { messages, messagesTop, messagesHeight, isShowingFireworks },\n    dispatch,\n  ] = useReducer(reducer, initialState);\n\n  const wrappedDispatch = useCallback(\n    (action: AppAction) => {\n      dispatch(action);\n\n      if (\n        action.type === 'addMessage' &&\n        action.payload.content.indexOf('say ') === 0\n      ) {\n        setTimeout(() => {\n          wrappedDispatch({\n            type: 'addMessage',\n            payload: {\n              sender: Sender.Other,\n              content: action.payload.content.slice(3).trim(),\n            },\n          });\n        }, 2_000);\n      }\n\n      if (\n        action.type === 'addMessage' &&\n        action.payload.content === 'congrats'\n      ) {\n        dispatch({\n          type: 'setIsShowingFireworks',\n          payload: {\n            isShowingFireworks: true,\n          },\n        });\n      }\n    },\n    [dispatch],\n  );\n\n  return (\n    <article className={style.Device}>\n      {isShowingFireworks && <Fireworks dispatch={dispatch} />}\n      <header className={style.Header}>Bot</header>\n      <Messages\n        messages={messages}\n        messagesTop={messagesTop}\n        messagesHeight={messagesHeight}\n        dispatch={dispatch}\n      />\n      <footer className={style.Footer}>\n        <Form dispatch={wrappedDispatch} />\n      </footer>\n    </article>\n  );\n};\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\n    ),\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA',\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.',\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.',\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import './index.css';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { App } from './components/App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}